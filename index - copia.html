<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mi Muro ✨</title>
<link rel="stylesheet" href="style.css">

<style>
body { margin:0; font-family:sans-serif; background:#111; color:#fff; }
#barra-superior { display:flex; align-items:center; gap:10px; padding:10px; background:#222; }
#barra-superior img { width:30px; height:30px; border-radius:50%; border:1px solid gold; object-fit:cover; }
#barra-superior span { font-weight:bold; color:gold; }
#btnVolver { background:none; border:none; color:#0ff; cursor:pointer; font-weight:bold; }

#muro-container { padding:20px; max-width:800px; margin:0 auto; }
#publicar { display:flex; flex-direction:column; gap:10px; margin-bottom:20px; }
#publicar textarea { width:100%; padding:10px; border-radius:10px; border:none; resize:none; }
#publicar input[type="file"] { color:#fff; }
#publicar button { background:linear-gradient(45deg,#ff0,#f0f); border:none; padding:10px; border-radius:10px; cursor:pointer; font-weight:bold; color:black; }

#feed { display:flex; flex-direction:column; gap:15px; }

.post { background:#222; padding:10px; border-radius:10px; display:flex; gap:10px; align-items:flex-start; }
.post img.avatar { width:40px; height:40px; border-radius:50%; border:1px solid gold; object-fit:cover; }
.post-content { display:flex; flex-direction:column; gap:5px; }
.post-content span { font-weight:bold; color:gold; }
.post-content p { margin:0; }

.confetti { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999; display:none; }
</style>
</head>
<body>

<!-- Barra superior -->
<div id="barra-superior">
  <button id="btnVolver">&#8592; Álbum</button>
  <img id="avatar-barra" src="https://i.ibb.co/781Qj0J/logo.png" alt="Avatar">
  <span id="usuarioActivo"></span>
</div>

<!-- Contenedor muro -->
<div id="muro-container">
  <h1>✨ Mi Muro ✨</h1>

  <!-- Sección publicar -->
  <div id="publicar">
    <textarea id="nuevoPost" placeholder="¿Qué querés compartir hoy?" rows="3"></textarea>
    <input type="file" id="imagenPost" accept="image/*">
    <button id="btnPublicar">Publicar</button>
  </div>

  <!-- Feed -->
  <div id="feed"></div>
</div>

<canvas class="confetti" id="confetti"></canvas>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<script>
// Usuario
let usuario = JSON.parse(localStorage.getItem('usuario')) || {nombre:'Cofundador', avatar:'https://i.ibb.co/781Qj0J/logo.png'};
document.getElementById('usuarioActivo').textContent = usuario.nombre;
document.getElementById('avatar-barra').src = usuario.avatar;

// Volver al álbum
document.getElementById('btnVolver').addEventListener('click', ()=>{ window.location.href='album.html'; });

// Guardar post en localStorage
const btnPublicar = document.getElementById('btnPublicar');
const feed = document.getElementById('feed');

function cargarFeed(){
  feed.innerHTML='';
  const posts = JSON.parse(localStorage.getItem('posts_'+usuario.nombre)) || [];
  posts.sort((a,b)=> b.timestamp - a.timestamp); // mostrar últimos primero
  posts.forEach(p=>{
    const div = document.createElement('div');
    div.className='post';
    div.innerHTML = `
      <img class="avatar" src="${usuario.avatar}">
      <div class="post-content">
        <span>${usuario.nombre}</span>
        <p>${p.texto}</p>
        ${p.imagen ? `<img src="${p.imagen}" style="max-width:200px;border-radius:10px;">` : ''}
      </div>
    `;
    feed.appendChild(div);
  });
}
cargarFeed();

// Publicar
btnPublicar.addEventListener('click', ()=>{
  const texto = document.getElementById('nuevoPost').value.trim();
  const archivo = document.getElementById('imagenPost').files[0];

  if(!texto && !archivo){ alert('Escribí algo o subí una imagen'); return; }

  if(archivo){
    const reader = new FileReader();
    reader.onload = ()=>{
      guardarPost(texto, reader.result);
    };
    reader.readAsDataURL(archivo);
  }else{
    guardarPost(texto,null);
  }
});

function guardarPost(texto, imagen){
  const posts = JSON.parse(localStorage.getItem('posts_'+usuario.nombre)) || [];
  posts.push({texto, imagen, timestamp:Date.now()});
  localStorage.setItem('posts_'+usuario.nombre, JSON.stringify(posts));
  document.getElementById('nuevoPost').value='';
  document.getElementById('imagenPost').value='';
  cargarFeed();
  lanzarConfetti();
}

// Confetti
function lanzarConfetti(){
  const canvas = document.getElementById('confetti');
  canvas.style.display='block';
  confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
  setTimeout(()=>{ canvas.style.display='none'; },1000);
}
</script>

</body>
</html>
